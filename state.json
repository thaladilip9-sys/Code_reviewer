{
    "files": [
        {
            "file_name": "auth.py",
            "language": "python",
            "code": "# src/auth.py\nimport os\nimport json\nimport sqlite3\nfrom typing import Dict, Any\nimport hashlib\nimport base64\n\n# Global variables - bad practice\nDATABASE_PATH = \"/tmp/users.db\"\nSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\nADMIN_PASSWORD = \"admin123\"  # Hardcoded password\n\nclass UserManager:\n    def __init__(self):\n        self.conn = None\n        self.setup_database()\n    \n    def setup_database(self):\n        \"\"\"Setup database with SQL injection vulnerability\"\"\"\n        self.conn = sqlite3.connect(DATABASE_PATH)\n        cursor = self.conn.cursor()\n        \n        # No error handling\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY,\n                username TEXT,\n                password TEXT,\n                email TEXT\n            )\n        ''')\n        \n        # Insert admin user with weak password\n        cursor.execute(f\"INSERT OR IGNORE INTO users (username, password, email) VALUES ('admin', '{ADMIN_PASSWORD}', 'admin@example.com')\")\n        self.conn.commit()\n    \n    def register_user(self, username: str, password: str, email: str) -> bool:\n        \"\"\"Register user with multiple security issues\"\"\"\n        \n        # No input validation\n        if not username or not password:\n            return False\n        \n        # Weak password check\n        if len(password) < 4:  # Too short\n            return False\n        \n        # SQL injection vulnerability\n        cursor = self.conn.cursor()\n        query = f\"INSERT INTO users (username, password, email) VALUES ('{username}', '{password}', '{email}')\"\n        \n        try:\n            cursor.execute(query)\n            self.conn.commit()\n            return True\n        except:\n            return False\n    \n    def login(self, username: str, password: str) -> Dict[str, Any]:\n        \"\"\"Login with security vulnerabilities\"\"\"\n        \n        # SQL injection\n        cursor = self.conn.cursor()\n        query = f\"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'\"\n        \n        cursor.execute(query)\n        user = cursor.fetchone()\n        \n        if user:\n            # Create JWT token without proper signing\n            token_data = {\n                \"user_id\": user[0],\n                \"username\": user[1],\n                \"is_admin\": user[1] == \"admin\"\n            }\n            \n            # Weak token generation\n            token = base64.b64encode(json.dumps(token_data).encode()).decode()\n            return {\"success\": True, \"token\": token, \"user\": user[1]}\n        \n        return {\"success\": False, \"error\": \"Invalid credentials\"}\n    \n    def get_user_data(self, user_id: int) -> Dict[str, Any]:\n        \"\"\"Get user data with IDOR vulnerability\"\"\"\n        cursor = self.conn.cursor()\n        \n        # Insecure direct object reference\n        query = f\"SELECT * FROM users WHERE id = {user_id}\"\n        cursor.execute(query)\n        user = cursor.fetchone()\n        \n        if user:\n            return {\n                \"id\": user[0],\n                \"username\": user[1],\n                \"email\": user[3],\n                \"password\": user[2]  # Exposing password!\n            }\n        return {}\n\ndef weak_hash_password(password: str) -> str:\n    \"\"\"Weak password hashing using MD5\"\"\"\n    return hashlib.md5(password.encode()).hexdigest()\n\ndef validate_email(email: str) -> bool:\n    \"\"\"Poor email validation\"\"\"\n    return \"@\" in email  # Very basic validation\n\ndef process_user_input(user_input: str) -> str:\n    \"\"\"No input sanitization\"\"\"\n    # Potential XSS and injection issues\n    return user_input.upper()\n\ndef unsafe_deserialize(data: str) -> Dict:\n    \"\"\"Unsafe deserialization\"\"\"\n    return eval(data)  # Dangerous!\n\ndef divide_numbers(a: int, b: int) -> float:\n    \"\"\"No error handling for division by zero\"\"\"\n    return a / b\n\ndef read_config_file(file_path: str) -> Dict:\n    \"\"\"Unsafe file reading\"\"\"\n    with open(file_path, 'r') as f:  # No path validation\n        return json.load(f)\n\ndef write_log(message: str):\n    \"\"\"Poor logging with potential log injection\"\"\"\n    log_entry = f\"LOG: {message}\\n\"\n    with open(\"/tmp/app.log\", \"a\") as f:\n        f.write(log_entry)  # No sanitization\n\n# Unused imports and variables\nunused_variable = \"This is never used\"\nanother_unused = 42\n\n# Poor function organization\ndef helper1():\n    pass\n\ndef helper2():\n    pass\n\ndef main_function():\n    \"\"\"Main function with multiple issues\"\"\"\n    manager = UserManager()\n    \n    # Hardcoded credentials in code\n    test_user = \"test\"\n    test_pass = \"test123\"\n    \n    # Register user\n    success = manager.register_user(test_user, test_pass, \"test@example.com\")\n    print(f\"Registration: {success}\")\n    \n    # Login\n    result = manager.login(test_user, test_pass)\n    print(f\"Login: {result}\")\n    \n    # Get user data (IDOR vulnerability)\n    user_data = manager.get_user_data(1)\n    print(f\"User data: {user_data}\")\n    \n    # Demonstrate other vulnerabilities\n    try:\n        # Division by zero\n        result = divide_numbers(10, 0)\n    except Exception as e:\n        print(f\"Division error: {e}\")\n    \n    # Weak hashing\n    weak_hash = weak_hash_password(\"password123\")\n    print(f\"Weak hash: {weak_hash}\")\n    \n    # Unsafe deserialization\n    malicious_data = \"__import__('os').system('rm -rf /')\"\n    # unsafe_deserialize(malicious_data)  # Commented out for safety\n\nif __name__ == \"__main__\":\n    main_function()",
            "analysis": [
                {
                    "tool": "Pylint",
                    "result": "Line 18: Trailing whitespace (trailing-whitespace)\nLine 23: Trailing whitespace (trailing-whitespace)\nLine 33: Trailing whitespace (trailing-whitespace)\nLine 35: Line too long (140/100) (line-too-long)\nLine 37: Trailing whitespace (trailing-whitespace)\nLine 40: Trailing whitespace (trailing-whitespace)\nLine 44: Trailing whitespace (trailing-whitespace)\nLine 48: Trailing whitespace (trailing-whitespace)\nLine 51: Line too long (111/100) (line-too-long)\nLine 52: Trailing whitespace (trailing-whitespace)\nLine 59: Trailing whitespace (trailing-whitespace)\nLine 62: Trailing whitespace (trailing-whitespace)\nLine 66: Trailing whitespace (trailing-whitespace)\nLine 69: Trailing whitespace (trailing-whitespace)\nLine 77: Trailing whitespace (trailing-whitespace)\nLine 81: Trailing whitespace (trailing-whitespace)\nLine 83: Trailing whitespace (trailing-whitespace)\nLine 87: Trailing whitespace (trailing-whitespace)\nLine 92: Trailing whitespace (trailing-whitespace)\nLine 148: Trailing whitespace (trailing-whitespace)\nLine 152: Trailing whitespace (trailing-whitespace)\nLine 156: Trailing whitespace (trailing-whitespace)\nLine 160: Trailing whitespace (trailing-whitespace)\nLine 164: Trailing whitespace (trailing-whitespace)\nLine 171: Trailing whitespace (trailing-whitespace)\nLine 175: Trailing whitespace (trailing-whitespace)\nLine 181: Final newline missing (missing-final-newline)\nLine 1: Missing module docstring (missing-module-docstring)\nLine 14: Missing class docstring (missing-class-docstring)\nLine 57: No exception type(s) specified (bare-except)\nLine 117: Use of eval (eval-used)\nLine 125: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 131: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 135: Constant name \"unused_variable\" doesn't conform to UPPER_CASE naming style (invalid-name)\nLine 136: Constant name \"another_unused\" doesn't conform to UPPER_CASE naming style (invalid-name)\nLine 139: Missing function or method docstring (missing-function-docstring)\nLine 142: Missing function or method docstring (missing-function-docstring)\nLine 169: Catching too general exception Exception (broad-exception-caught)\nLine 177: Unused variable 'malicious_data' (unused-variable)\nLine 2: Unused import os (unused-import)"
                },
                {
                    "tool": "Flake8",
                    "result": "C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:2:1: F401 'os' imported but unused\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:14:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:18:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:23:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:33:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:35:89: E501 line too long (140 > 88 characters)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:37:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:40:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:44:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:48:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:51:89: E501 line too long (111 > 88 characters)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:52:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:57:9: E722 do not use bare 'except'\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:59:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:62:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:65:89: E501 line too long (96 > 88 characters)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:66:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:69:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:77:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:81:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:83:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:87:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:92:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:102:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:106:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:110:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:115:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:119:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:123:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:128:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:135:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:139:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:142:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:145:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:148:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:152:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:156:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:160:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:164:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:171:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:175:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:177:5: F841 local variable 'malicious_data' is assigned to but never used\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:180:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:181:20: W292 no newline at end of file"
                },
                {
                    "tool": "Ruff",
                    "result": "F401 [*] `os` imported but unused\n --> tmp_17s_vcy.py:2:8\n  |\n1 | # src/auth.py\n2 | import os\n  |        ^^\n3 | import json\n4 | import sqlite3\n  |\nhelp: Remove unused import: `os`\n\nE722 Do not use bare `except`\n  --> tmp_17s_vcy.py:57:9\n   |\n55 |             self.conn.commit()\n56 |             return True\n57 |         except:\n   |         ^^^^^^\n58 |             return False\n   |\n\nF841 Local variable `malicious_data` is assigned to but never used\n   --> tmp_17s_vcy.py:177:5\n    |\n176 |     # Unsafe deserialization\n177 |     malicious_data = \"__import__('os').system('rm -rf /')\"\n    |     ^^^^^^^^^^^^^^\n178 |     # unsafe_deserialize(malicious_data)  # Commented out for safety\n    |\nhelp: Remove assignment to unused variable `malicious_data`"
                },
                {
                    "tool": "Bandit",
                    "result": "Run started:2025-10-14 14:03:05.164108\n\nTest results:\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:10:16\n9\t# Global variables - bad practice\n10\tDATABASE_PATH = \"/tmp/users.db\"\n11\tSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hardcoded_secret_key_12345'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:11:13\n10\tDATABASE_PATH = \"/tmp/users.db\"\n11\tSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\n12\tADMIN_PASSWORD = \"admin123\"  # Hardcoded password\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'admin123'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:12:17\n11\tSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\n12\tADMIN_PASSWORD = \"admin123\"  # Hardcoded password\n13\t\n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:51:16\n50\t        cursor = self.conn.cursor()\n51\t        query = f\"INSERT INTO users (username, password, email) VALUES ('{username}', '{password}', '{email}')\"\n52\t        \n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:65:16\n64\t        cursor = self.conn.cursor()\n65\t        query = f\"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'\"\n66\t        \n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:89:16\n88\t        # Insecure direct object reference\n89\t        query = f\"SELECT * FROM users WHERE id = {user_id}\"\n90\t        cursor.execute(query)\n\n--------------------------------------------------\n>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False\n   Severity: High   Confidence: High\n   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:104:11\n103\t    \"\"\"Weak password hashing using MD5\"\"\"\n104\t    return hashlib.md5(password.encode()).hexdigest()\n105\t\n\n--------------------------------------------------\n>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.\n   Severity: Medium   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:117:11\n116\t    \"\"\"Unsafe deserialization\"\"\"\n117\t    return eval(data)  # Dangerous!\n118\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:131:14\n130\t    log_entry = f\"LOG: {message}\\n\"\n131\t    with open(\"/tmp/app.log\", \"a\") as f:\n132\t        f.write(log_entry)  # No sanitization\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test123'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:151:16\n150\t    test_user = \"test\"\n151\t    test_pass = \"test123\"\n152\t    \n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 120\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 3\n\t\tMedium: 6\n\t\tHigh: 1\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 3\n\t\tMedium: 5\n\t\tHigh: 2\nFiles skipped (0):"
                },
                {
                    "tool": "MyPy",
                    "result": "No issues found."
                }
            ]
        },
        {
            "file_name": "sample.py",
            "language": "python",
            "code": "# bad_code_sample_v2.py\n# Intentionally insecure & non-idiomatic Python for testing analyzers.\n\nimport os, sys, json, sqlite3, hashlib, subprocess\n\n# Hardcoded credentials (Bandit will flag)\nDB_PASSWORD = \"P@ssw0rd123!\"\nAPI_KEY = \"AKIAEXAMPLESECRETKEY\"\nSECRET_TOKEN = \"s3cr3t-token-123\"\n\n# Global bad naming / shadowing builtins\nX = 5\nY=10\nlist = [1,2,3]  # shadowing built-in\n\n# Missing type hints and poor formatting\ndef add(a,b):\n  return a +  b\n\n# Function returning wrong type (MyPy will complain)\ndef greet(name: str) -> int:\n    print(\"Hello \" + name)\n    return \"Done\"  # wrong return type\n\n# Dangerous: shell command + no validation (Bandit)\ndef remove_all_logs():\n    # no checks; dangerous hardcoded path and shell=True like behavior\n    os.system(\"rm -rf /var/log\")\n\n# Dangerous use of subprocess with shell-like behavior (Bandit)\ndef run_user_command(cmd):\n    # imagine cmd comes from user input \u2014 vulnerable to injection\n    subprocess.Popen(cmd, shell=True)\n\n# Insecure eval usage (Bandit)\ndef evaluate_user_expr(expr):\n    # insecure: executing arbitrary expressions\n    return eval(expr)\n\n# Weak hashing (MD5) and use of secrets in code\ndef hash_password(pwd: str) -> str:\n    # weak cryptography (md5) \u2014 Bandit will flag\n    return hashlib.md5(pwd.encode()).hexdigest()\n\n# SQL injection style string formatting + missing exception handling\ndef add_user_to_db(username, password):\n    conn = sqlite3.connect(\"/tmp/users.db\")\n    cursor = conn.cursor()\n    # BAD: direct string interpolation into SQL (SQLi)\n    sql = f\"INSERT INTO users (username, password) VALUES ('{username}', '{password}')\"\n    cursor.execute(sql)\n    conn.commit()\n    conn.close()\n\n# File operation without exception handling (flat code)\ndef read_config():\n    # no try/except \u2014 will crash if file missing or parse fails\n    with open(\"/etc/myapp/config.json\", \"r\") as f:\n        cfg = json.load(f)\n    return cfg\n\n# Missing validation and no error handling for network-like operations\ndef send_token(token):\n    # pretend to send token; no validation or safe storage\n    print(\"Sending token:\", token)\n    # insecure: printing secret to logs\n\n# Inconsistent indentation and mixed tabs/spaces\ndef weird_indent():\n\tif True:\n\t print (\"Tabs and spaces mixed\")\n\t print('This line uses tabs')\n\n# Unused function and variables (style issues)\ndef UnusedFunction():\n    pass\n\n# Exposed secret in docstring / comments (some analyzers can flag)\n\"\"\"\nDoc: DB_PASSWORD = P@ssw0rd123!  # DO NOT COMMIT SECRETS\n\"\"\"\n\nif __name__==\"__main__\":\n  # flat, no top-level exception handling: any error will crash the program\n  greet(\"World\")\n  add(3 ,4)\n  remove_all_logs()\n  print(\"Hashed:\", hash_password(DB_PASSWORD))\n  run_user_command(\"ls -la /tmp\")    # potentially unsafe\n  print(\"Eval result:\", evaluate_user_expr(\"2 + 3\"))\n  # Potential SQL injection demo\n  add_user_to_db(\"alice\", DB_PASSWORD)\n  cfg = read_config()\n  print(cfg.get(\"some_key\"))\n",
            "analysis": [
                {
                    "tool": "Pylint",
                    "result": "Line 18: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 70: Bad indentation. Found 1 spaces, expected 4 (bad-indentation)\nLine 71: Bad indentation. Found 2 spaces, expected 8 (bad-indentation)\nLine 72: Bad indentation. Found 2 spaces, expected 8 (bad-indentation)\nLine 85: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 86: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 87: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 88: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 89: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 90: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 92: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 93: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 94: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 1: Missing module docstring (missing-module-docstring)\nLine 14: Redefining built-in 'list' (redefined-builtin)\nLine 4: Multiple imports on one line (os, sys, json, sqlite3, hashlib, subprocess) (multiple-imports)\nLine 17: Missing function or method docstring (missing-function-docstring)\nLine 21: Missing function or method docstring (missing-function-docstring)\nLine 26: Missing function or method docstring (missing-function-docstring)\nLine 31: Missing function or method docstring (missing-function-docstring)\nLine 33: Consider using 'with' for resource-allocating operations (consider-using-with)\nLine 36: Missing function or method docstring (missing-function-docstring)\nLine 38: Use of eval (eval-used)\nLine 41: Missing function or method docstring (missing-function-docstring)\nLine 46: Missing function or method docstring (missing-function-docstring)\nLine 56: Missing function or method docstring (missing-function-docstring)\nLine 59: Redefining name 'cfg' from outer scope (line 93) (redefined-outer-name)\nLine 58: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 63: Missing function or method docstring (missing-function-docstring)\nLine 69: Missing function or method docstring (missing-function-docstring)\nLine 70: Using a conditional statement with a constant value (using-constant-test)\nLine 75: Missing function or method docstring (missing-function-docstring)\nLine 75: Function name \"UnusedFunction\" doesn't conform to snake_case naming style (invalid-name)\nLine 79: String statement has no effect (pointless-string-statement)\nLine 4: Unused import sys (unused-import)"
                },
                {
                    "tool": "Flake8",
                    "result": "C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:4:1: F401 'sys' imported but unused\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:4:10: E401 multiple imports on one line\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:13:2: E225 missing whitespace around operator\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:14:10: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:14:12: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:17:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:17:10: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:18:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:18:13: E222 multiple spaces after operator\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:21:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:26:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:31:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:36:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:41:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:46:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:56:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:63:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:69:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:70:1: W191 indentation contains tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:70:1: E101 indentation contains mixed spaces and tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:70:2: E117 over-indented\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:1: W191 indentation contains tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:1: E101 indentation contains mixed spaces and tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:8: E211 whitespace before '('\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:72:1: W191 indentation contains tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:72:1: E101 indentation contains mixed spaces and tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:72:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:75:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:79:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:83:12: E225 missing whitespace around operator\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:84:3: E114 indentation is not a multiple of 4 (comment)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:85:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:86:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:86:8: E203 whitespace before ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:86:9: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:87:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:88:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:89:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:90:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:91:3: E114 indentation is not a multiple of 4 (comment)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:92:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:93:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:94:3: E111 indentation is not a multiple of 4"
                },
                {
                    "tool": "Ruff",
                    "result": "E401 [*] Multiple imports on one line\n --> tmppuixfmvg.py:4:1\n  |\n2 | # Intentionally insecure & non-idiomatic Python for testing analyzers.\n3 |\n4 | import os, sys, json, sqlite3, hashlib, subprocess\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n5 |\n6 | # Hardcoded credentials (Bandit will flag)\n  |\nhelp: Split imports\n\nF401 [*] `sys` imported but unused\n --> tmppuixfmvg.py:4:12\n  |\n2 | # Intentionally insecure & non-idiomatic Python for testing analyzers.\n3 |\n4 | import os, sys, json, sqlite3, hashlib, subprocess\n  |            ^^^\n5 |\n6 | # Hardcoded credentials (Bandit will flag)\n  |\nhelp: Remove unused import: `sys`"
                },
                {
                    "tool": "Bandit",
                    "result": "Run started:2025-10-14 14:03:08.075410\n\nTest results:\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:4:0\n3\t\n4\timport os, sys, json, sqlite3, hashlib, subprocess\n5\t\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'P@ssw0rd123!'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:7:14\n6\t# Hardcoded credentials (Bandit will flag)\n7\tDB_PASSWORD = \"P@ssw0rd123!\"\n8\tAPI_KEY = \"AKIAEXAMPLESECRETKEY\"\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's3cr3t-token-123'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:9:15\n8\tAPI_KEY = \"AKIAEXAMPLESECRETKEY\"\n9\tSECRET_TOKEN = \"s3cr3t-token-123\"\n10\t\n\n--------------------------------------------------\n>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:28:4\n27\t    # no checks; dangerous hardcoded path and shell=True like behavior\n28\t    os.system(\"rm -rf /var/log\")\n29\t\n\n--------------------------------------------------\n>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b607_start_process_with_partial_path.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:28:4\n27\t    # no checks; dangerous hardcoded path and shell=True like behavior\n28\t    os.system(\"rm -rf /var/log\")\n29\t\n\n--------------------------------------------------\n>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.\n   Severity: High   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:33:4\n32\t    # imagine cmd comes from user input \u2014 vulnerable to injection\n33\t    subprocess.Popen(cmd, shell=True)\n34\t\n\n--------------------------------------------------\n>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.\n   Severity: Medium   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:38:11\n37\t    # insecure: executing arbitrary expressions\n38\t    return eval(expr)\n39\t\n\n--------------------------------------------------\n>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False\n   Severity: High   Confidence: High\n   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:43:11\n42\t    # weak cryptography (md5) \u2014 Bandit will flag\n43\t    return hashlib.md5(pwd.encode()).hexdigest()\n44\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:47:27\n46\tdef add_user_to_db(username, password):\n47\t    conn = sqlite3.connect(\"/tmp/users.db\")\n48\t    cursor = conn.cursor()\n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:50:10\n49\t    # BAD: direct string interpolation into SQL (SQLi)\n50\t    sql = f\"INSERT INTO users (username, password) VALUES ('{username}', '{password}')\"\n51\t    cursor.execute(sql)\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 52\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 5\n\t\tMedium: 3\n\t\tHigh: 2\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 1\n\t\tMedium: 3\n\t\tHigh: 6\nFiles skipped (0):"
                },
                {
                    "tool": "MyPy",
                    "result": "tmppuixfmvg.py:23: error: Incompatible return value type (got \"str\", expected \"int\")  [return-value]"
                }
            ]
        },
        {
            "file_name": "utils.py",
            "language": "python",
            "code": "# src/utils.py\nimport pickle\nimport subprocess\nimport sys\nfrom pathlib import Path\n\nclass ConfigManager:\n    def __init__(self):\n        self.config = {}\n    \n    def load_config(self, config_path: str):\n        \"\"\"Unsafe pickle loading\"\"\"\n        with open(config_path, 'rb') as f:\n            self.config = pickle.load(f)  # Dangerous!\n    \n    def execute_command(self, command: str):\n        \"\"\"Command injection vulnerability\"\"\"\n        # No input validation\n        result = subprocess.run(command, shell=True, capture_output=True, text=True)\n        return result.stdout\n    \n    def read_arbitrary_file(self, file_path: str) -> str:\n        \"\"\"Path traversal vulnerability\"\"\"\n        base_dir = Path(\"/app/data\")\n        target_file = base_dir / file_path  # No path sanitization\n        \n        with open(target_file, 'r') as f:\n            return f.read()\n    \n    def unsafe_eval(self, expression: str):\n        \"\"\"Unsafe eval usage\"\"\"\n        return eval(expression)\n\ndef create_user_object(data: dict):\n    \"\"\"Class with too many responsibilities\"\"\"\n    class User:\n        def __init__(self, data):\n            self.data = data\n            self.db_connection = None\n            self.cache = {}\n            self.logger = None\n        \n        def validate(self):\n            # Too many validations in one method\n            if 'email' in self.data:\n                if '@' not in self.data['email']:\n                    return False\n            if 'password' in self.data:\n                if len(self.data['password']) < 3:\n                    return False\n            if 'username' in self.data:\n                if len(self.data['username']) < 2:\n                    return False\n            return True\n        \n        def save_to_db(self):\n            # Mixing concerns\n            pass\n        \n        def send_email(self):\n            # Should not be here\n            pass\n        \n        def generate_report(self):\n            # Too many responsibilities\n            pass\n    \n    return User(data)\n\n# Global state manipulation\nglobal_state = {}\n\ndef update_global_state(key: str, value: any):\n    \"\"\"Function with side effects\"\"\"\n    global_state[key] = value\n    # Also modifies external state\n    with open(\"/tmp/state.json\", \"w\") as f:\n        import json\n        json.dump(global_state, f)\n\n# Poor exception handling\ndef risky_operation():\n    try:\n        # Too broad exception handling\n        result = 10 / 0\n    except:\n        pass  # Silent failure\n\n# Inconsistent naming\ndef GetData():\n    return {\"data\": \"value\"}\n\ndef process_data():\n    return GetData()\n\ndef CalculateTotal():\n    return 100\n\n# Dead code\ndef unused_function():\n    return \"This is never called\"\n\ndef another_unused():\n    print(\"Also never used\")\n\n# Long function with multiple responsibilities\ndef process_user_request(request_data: dict) -> dict:\n    \"\"\"Function doing too many things\"\"\"\n    # Validation\n    if 'user_id' not in request_data:\n        return {\"error\": \"Missing user_id\"}\n    \n    # Database operation\n    import sqlite3\n    conn = sqlite3.connect(\"/tmp/app.db\")\n    cursor = conn.cursor()\n    cursor.execute(f\"SELECT * FROM users WHERE id = {request_data['user_id']}\")\n    user = cursor.fetchone()\n    \n    # Business logic\n    if user:\n        if user[3] == 'premium':  # Magic number\n            discount = 0.1\n        else:\n            discount = 0.0\n        \n        # Calculation\n        total = 100 * (1 - discount)\n        \n        # Formatting\n        response = {\n            \"user\": user[1],\n            \"total\": total,\n            \"discount\": discount\n        }\n        \n        # Logging\n        print(f\"Processed request for user {user[1]}\")\n        \n        return response\n    \n    return {\"error\": \"User not found\"}\n\nif __name__ == \"__main__\":\n    manager = ConfigManager()\n    manager.execute_command(\"ls -la\")  # Safe example, but pattern is dangerous",
            "analysis": [
                {
                    "tool": "Pylint",
                    "result": "Line 10: Trailing whitespace (trailing-whitespace)\nLine 15: Trailing whitespace (trailing-whitespace)\nLine 21: Trailing whitespace (trailing-whitespace)\nLine 26: Trailing whitespace (trailing-whitespace)\nLine 29: Trailing whitespace (trailing-whitespace)\nLine 42: Trailing whitespace (trailing-whitespace)\nLine 55: Trailing whitespace (trailing-whitespace)\nLine 59: Trailing whitespace (trailing-whitespace)\nLine 63: Trailing whitespace (trailing-whitespace)\nLine 67: Trailing whitespace (trailing-whitespace)\nLine 112: Trailing whitespace (trailing-whitespace)\nLine 119: Trailing whitespace (trailing-whitespace)\nLine 126: Trailing whitespace (trailing-whitespace)\nLine 129: Trailing whitespace (trailing-whitespace)\nLine 136: Trailing whitespace (trailing-whitespace)\nLine 139: Trailing whitespace (trailing-whitespace)\nLine 141: Trailing whitespace (trailing-whitespace)\nLine 146: Final newline missing (missing-final-newline)\nLine 1: Missing module docstring (missing-module-docstring)\nLine 7: Missing class docstring (missing-class-docstring)\nLine 19: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)\nLine 27: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 32: Use of eval (eval-used)\nLine 36: Missing class docstring (missing-class-docstring)\nLine 43: Missing function or method docstring (missing-function-docstring)\nLine 56: Missing function or method docstring (missing-function-docstring)\nLine 60: Missing function or method docstring (missing-function-docstring)\nLine 64: Missing function or method docstring (missing-function-docstring)\nLine 77: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 78: Import outside toplevel (json) (import-outside-toplevel)\nLine 82: Missing function or method docstring (missing-function-docstring)\nLine 86: No exception type(s) specified (bare-except)\nLine 85: Unused variable 'result' (unused-variable)\nLine 90: Missing function or method docstring (missing-function-docstring)\nLine 90: Function name \"GetData\" doesn't conform to snake_case naming style (invalid-name)\nLine 93: Missing function or method docstring (missing-function-docstring)\nLine 96: Missing function or method docstring (missing-function-docstring)\nLine 96: Function name \"CalculateTotal\" doesn't conform to snake_case naming style (invalid-name)\nLine 100: Missing function or method docstring (missing-function-docstring)\nLine 103: Missing function or method docstring (missing-function-docstring)\nLine 114: Import outside toplevel (sqlite3) (import-outside-toplevel)\nLine 4: Unused import sys (unused-import)"
                },
                {
                    "tool": "Flake8",
                    "result": "C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:4:1: F401 'sys' imported but unused\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:7:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:10:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:15:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:21:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:26:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:29:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:34:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:42:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:55:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:59:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:63:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:67:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:71:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:73:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:82:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:85:9: F841 local variable 'result' is assigned to but never used\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:86:5: E722 do not use bare 'except'\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:90:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:93:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:96:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:100:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:103:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:107:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:112:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:119:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:126:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:129:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:136:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:139:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:141:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:144:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:146:80: W292 no newline at end of file"
                },
                {
                    "tool": "Ruff",
                    "result": "F401 [*] `sys` imported but unused\n --> tmpk273_tbh.py:4:8\n  |\n2 | import pickle\n3 | import subprocess\n4 | import sys\n  |        ^^^\n5 | from pathlib import Path\n  |\nhelp: Remove unused import: `sys`\n\nF841 Local variable `result` is assigned to but never used\n  --> tmpk273_tbh.py:85:9\n   |\n83 |     try:\n84 |         # Too broad exception handling\n85 |         result = 10 / 0\n   |         ^^^^^^\n86 |     except:\n87 |         pass  # Silent failure\n   |\nhelp: Remove assignment to unused variable `result`\n\nE722 Do not use bare `except`\n  --> tmpk273_tbh.py:86:5\n   |\n84 |         # Too broad exception handling\n85 |         result = 10 / 0\n86 |     except:\n   |     ^^^^^^\n87 |         pass  # Silent failure\n   |"
                },
                {
                    "tool": "Bandit",
                    "result": "Run started:2025-10-14 14:03:11.424252\n\nTest results:\n>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.\n   Severity: Low   Confidence: High\n   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b403-import-pickle\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:2:0\n1\t# src/utils.py\n2\timport pickle\n3\timport subprocess\n\n--------------------------------------------------\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:3:0\n2\timport pickle\n3\timport subprocess\n4\timport sys\n\n--------------------------------------------------\n>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.\n   Severity: Medium   Confidence: High\n   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:14:26\n13\t        with open(config_path, 'rb') as f:\n14\t            self.config = pickle.load(f)  # Dangerous!\n15\t    \n\n--------------------------------------------------\n>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.\n   Severity: High   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:19:17\n18\t        # No input validation\n19\t        result = subprocess.run(command, shell=True, capture_output=True, text=True)\n20\t        return result.stdout\n\n--------------------------------------------------\n>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.\n   Severity: Medium   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:32:15\n31\t        \"\"\"Unsafe eval usage\"\"\"\n32\t        return eval(expression)\n33\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:77:14\n76\t    # Also modifies external state\n77\t    with open(\"/tmp/state.json\", \"w\") as f:\n78\t        import json\n\n--------------------------------------------------\n>> Issue: [B110:try_except_pass] Try, Except, Pass detected.\n   Severity: Low   Confidence: High\n   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:86:4\n85\t        result = 10 / 0\n86\t    except:\n87\t        pass  # Silent failure\n88\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:115:27\n114\t    import sqlite3\n115\t    conn = sqlite3.connect(\"/tmp/app.db\")\n116\t    cursor = conn.cursor()\n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:117:19\n116\t    cursor = conn.cursor()\n117\t    cursor.execute(f\"SELECT * FROM users WHERE id = {request_data['user_id']}\")\n118\t    user = cursor.fetchone()\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 98\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 3\n\t\tMedium: 5\n\t\tHigh: 1\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 3\n\t\tHigh: 6\nFiles skipped (0):"
                },
                {
                    "tool": "MyPy",
                    "result": "tmpk273_tbh.py:73: error: Function \"builtins.any\" is not valid as a type  [valid-type]\ntmpk273_tbh.py:73: note: Perhaps you meant \"typing.Any\" instead of \"any\"?"
                }
            ]
        }
    ],
    "file_paths": [
        "sample_code_repo"
    ],
    "requirements": {
        "user_stories": [
            "As a user, I want to register with email and password",
            "As a user, I want to login with my credentials",
            "As a user, I want to reset my password if forgotten",
            "As an admin, I want to manage user accounts"
        ],
        "functional_requirements": [
            "Secure user registration with validation",
            "JWT-based authentication system",
            "Password hashing with strong algorithm",
            "Input validation to prevent SQL injection",
            "Proper error handling and logging",
            "Secure configuration management"
        ],
        "security_requirements": [
            "No hardcoded credentials",
            "Input sanitization for all user inputs",
            "Secure password storage",
            "Protection against common vulnerabilities (SQLi, XSS, etc.)",
            "Proper access controls"
        ]
    },
    "standards_result": {
        "files": [
            {
                "file_name": "auth.py",
                "language": "python",
                "code": "# src/auth.py\nimport os\nimport json\nimport sqlite3\nfrom typing import Dict, Any\nimport hashlib\nimport base64\n\n# Global variables - bad practice\nDATABASE_PATH = \"/tmp/users.db\"\nSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\nADMIN_PASSWORD = \"admin123\"  # Hardcoded password\n\nclass UserManager:\n    def __init__(self):\n        self.conn = None\n        self.setup_database()\n    \n    def setup_database(self):\n        \"\"\"Setup database with SQL injection vulnerability\"\"\"\n        self.conn = sqlite3.connect(DATABASE_PATH)\n        cursor = self.conn.cursor()\n        \n        # No error handling\n        cursor.execute('''\n            CREATE TABLE IF NOT EXISTS users (\n                id INTEGER PRIMARY KEY,\n                username TEXT,\n                password TEXT,\n                email TEXT\n            )\n        ''')\n        \n        # Insert admin user with weak password\n        cursor.execute(f\"INSERT OR IGNORE INTO users (username, password, email) VALUES ('admin', '{ADMIN_PASSWORD}', 'admin@example.com')\")\n        self.conn.commit()\n    \n    def register_user(self, username: str, password: str, email: str) -> bool:\n        \"\"\"Register user with multiple security issues\"\"\"\n        \n        # No input validation\n        if not username or not password:\n            return False\n        \n        # Weak password check\n        if len(password) < 4:  # Too short\n            return False\n        \n        # SQL injection vulnerability\n        cursor = self.conn.cursor()\n        query = f\"INSERT INTO users (username, password, email) VALUES ('{username}', '{password}', '{email}')\"\n        \n        try:\n            cursor.execute(query)\n            self.conn.commit()\n            return True\n        except:\n            return False\n    \n    def login(self, username: str, password: str) -> Dict[str, Any]:\n        \"\"\"Login with security vulnerabilities\"\"\"\n        \n        # SQL injection\n        cursor = self.conn.cursor()\n        query = f\"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'\"\n        \n        cursor.execute(query)\n        user = cursor.fetchone()\n        \n        if user:\n            # Create JWT token without proper signing\n            token_data = {\n                \"user_id\": user[0],\n                \"username\": user[1],\n                \"is_admin\": user[1] == \"admin\"\n            }\n            \n            # Weak token generation\n            token = base64.b64encode(json.dumps(token_data).encode()).decode()\n            return {\"success\": True, \"token\": token, \"user\": user[1]}\n        \n        return {\"success\": False, \"error\": \"Invalid credentials\"}\n    \n    def get_user_data(self, user_id: int) -> Dict[str, Any]:\n        \"\"\"Get user data with IDOR vulnerability\"\"\"\n        cursor = self.conn.cursor()\n        \n        # Insecure direct object reference\n        query = f\"SELECT * FROM users WHERE id = {user_id}\"\n        cursor.execute(query)\n        user = cursor.fetchone()\n        \n        if user:\n            return {\n                \"id\": user[0],\n                \"username\": user[1],\n                \"email\": user[3],\n                \"password\": user[2]  # Exposing password!\n            }\n        return {}\n\ndef weak_hash_password(password: str) -> str:\n    \"\"\"Weak password hashing using MD5\"\"\"\n    return hashlib.md5(password.encode()).hexdigest()\n\ndef validate_email(email: str) -> bool:\n    \"\"\"Poor email validation\"\"\"\n    return \"@\" in email  # Very basic validation\n\ndef process_user_input(user_input: str) -> str:\n    \"\"\"No input sanitization\"\"\"\n    # Potential XSS and injection issues\n    return user_input.upper()\n\ndef unsafe_deserialize(data: str) -> Dict:\n    \"\"\"Unsafe deserialization\"\"\"\n    return eval(data)  # Dangerous!\n\ndef divide_numbers(a: int, b: int) -> float:\n    \"\"\"No error handling for division by zero\"\"\"\n    return a / b\n\ndef read_config_file(file_path: str) -> Dict:\n    \"\"\"Unsafe file reading\"\"\"\n    with open(file_path, 'r') as f:  # No path validation\n        return json.load(f)\n\ndef write_log(message: str):\n    \"\"\"Poor logging with potential log injection\"\"\"\n    log_entry = f\"LOG: {message}\\n\"\n    with open(\"/tmp/app.log\", \"a\") as f:\n        f.write(log_entry)  # No sanitization\n\n# Unused imports and variables\nunused_variable = \"This is never used\"\nanother_unused = 42\n\n# Poor function organization\ndef helper1():\n    pass\n\ndef helper2():\n    pass\n\ndef main_function():\n    \"\"\"Main function with multiple issues\"\"\"\n    manager = UserManager()\n    \n    # Hardcoded credentials in code\n    test_user = \"test\"\n    test_pass = \"test123\"\n    \n    # Register user\n    success = manager.register_user(test_user, test_pass, \"test@example.com\")\n    print(f\"Registration: {success}\")\n    \n    # Login\n    result = manager.login(test_user, test_pass)\n    print(f\"Login: {result}\")\n    \n    # Get user data (IDOR vulnerability)\n    user_data = manager.get_user_data(1)\n    print(f\"User data: {user_data}\")\n    \n    # Demonstrate other vulnerabilities\n    try:\n        # Division by zero\n        result = divide_numbers(10, 0)\n    except Exception as e:\n        print(f\"Division error: {e}\")\n    \n    # Weak hashing\n    weak_hash = weak_hash_password(\"password123\")\n    print(f\"Weak hash: {weak_hash}\")\n    \n    # Unsafe deserialization\n    malicious_data = \"__import__('os').system('rm -rf /')\"\n    # unsafe_deserialize(malicious_data)  # Commented out for safety\n\nif __name__ == \"__main__\":\n    main_function()",
                "analysis": [
                    {
                        "tool": "Pylint",
                        "result": "Line 18: Trailing whitespace (trailing-whitespace)\nLine 23: Trailing whitespace (trailing-whitespace)\nLine 33: Trailing whitespace (trailing-whitespace)\nLine 35: Line too long (140/100) (line-too-long)\nLine 37: Trailing whitespace (trailing-whitespace)\nLine 40: Trailing whitespace (trailing-whitespace)\nLine 44: Trailing whitespace (trailing-whitespace)\nLine 48: Trailing whitespace (trailing-whitespace)\nLine 51: Line too long (111/100) (line-too-long)\nLine 52: Trailing whitespace (trailing-whitespace)\nLine 59: Trailing whitespace (trailing-whitespace)\nLine 62: Trailing whitespace (trailing-whitespace)\nLine 66: Trailing whitespace (trailing-whitespace)\nLine 69: Trailing whitespace (trailing-whitespace)\nLine 77: Trailing whitespace (trailing-whitespace)\nLine 81: Trailing whitespace (trailing-whitespace)\nLine 83: Trailing whitespace (trailing-whitespace)\nLine 87: Trailing whitespace (trailing-whitespace)\nLine 92: Trailing whitespace (trailing-whitespace)\nLine 148: Trailing whitespace (trailing-whitespace)\nLine 152: Trailing whitespace (trailing-whitespace)\nLine 156: Trailing whitespace (trailing-whitespace)\nLine 160: Trailing whitespace (trailing-whitespace)\nLine 164: Trailing whitespace (trailing-whitespace)\nLine 171: Trailing whitespace (trailing-whitespace)\nLine 175: Trailing whitespace (trailing-whitespace)\nLine 181: Final newline missing (missing-final-newline)\nLine 1: Missing module docstring (missing-module-docstring)\nLine 14: Missing class docstring (missing-class-docstring)\nLine 57: No exception type(s) specified (bare-except)\nLine 117: Use of eval (eval-used)\nLine 125: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 131: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 135: Constant name \"unused_variable\" doesn't conform to UPPER_CASE naming style (invalid-name)\nLine 136: Constant name \"another_unused\" doesn't conform to UPPER_CASE naming style (invalid-name)\nLine 139: Missing function or method docstring (missing-function-docstring)\nLine 142: Missing function or method docstring (missing-function-docstring)\nLine 169: Catching too general exception Exception (broad-exception-caught)\nLine 177: Unused variable 'malicious_data' (unused-variable)\nLine 2: Unused import os (unused-import)"
                    },
                    {
                        "tool": "Flake8",
                        "result": "C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:2:1: F401 'os' imported but unused\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:14:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:18:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:23:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:33:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:35:89: E501 line too long (140 > 88 characters)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:37:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:40:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:44:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:48:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:51:89: E501 line too long (111 > 88 characters)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:52:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:57:9: E722 do not use bare 'except'\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:59:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:62:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:65:89: E501 line too long (96 > 88 characters)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:66:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:69:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:77:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:81:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:83:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:87:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:92:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:102:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:106:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:110:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:115:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:119:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:123:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:128:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:135:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:139:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:142:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:145:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:148:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:152:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:156:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:160:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:164:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:171:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:175:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:177:5: F841 local variable 'malicious_data' is assigned to but never used\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:180:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:181:20: W292 no newline at end of file"
                    },
                    {
                        "tool": "Ruff",
                        "result": "F401 [*] `os` imported but unused\n --> tmp_17s_vcy.py:2:8\n  |\n1 | # src/auth.py\n2 | import os\n  |        ^^\n3 | import json\n4 | import sqlite3\n  |\nhelp: Remove unused import: `os`\n\nE722 Do not use bare `except`\n  --> tmp_17s_vcy.py:57:9\n   |\n55 |             self.conn.commit()\n56 |             return True\n57 |         except:\n   |         ^^^^^^\n58 |             return False\n   |\n\nF841 Local variable `malicious_data` is assigned to but never used\n   --> tmp_17s_vcy.py:177:5\n    |\n176 |     # Unsafe deserialization\n177 |     malicious_data = \"__import__('os').system('rm -rf /')\"\n    |     ^^^^^^^^^^^^^^\n178 |     # unsafe_deserialize(malicious_data)  # Commented out for safety\n    |\nhelp: Remove assignment to unused variable `malicious_data`"
                    },
                    {
                        "tool": "Bandit",
                        "result": "Run started:2025-10-14 14:03:05.164108\n\nTest results:\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:10:16\n9\t# Global variables - bad practice\n10\tDATABASE_PATH = \"/tmp/users.db\"\n11\tSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hardcoded_secret_key_12345'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:11:13\n10\tDATABASE_PATH = \"/tmp/users.db\"\n11\tSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\n12\tADMIN_PASSWORD = \"admin123\"  # Hardcoded password\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'admin123'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:12:17\n11\tSECRET_KEY = \"hardcoded_secret_key_12345\"  # Hardcoded secret\n12\tADMIN_PASSWORD = \"admin123\"  # Hardcoded password\n13\t\n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:51:16\n50\t        cursor = self.conn.cursor()\n51\t        query = f\"INSERT INTO users (username, password, email) VALUES ('{username}', '{password}', '{email}')\"\n52\t        \n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:65:16\n64\t        cursor = self.conn.cursor()\n65\t        query = f\"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'\"\n66\t        \n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:89:16\n88\t        # Insecure direct object reference\n89\t        query = f\"SELECT * FROM users WHERE id = {user_id}\"\n90\t        cursor.execute(query)\n\n--------------------------------------------------\n>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False\n   Severity: High   Confidence: High\n   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:104:11\n103\t    \"\"\"Weak password hashing using MD5\"\"\"\n104\t    return hashlib.md5(password.encode()).hexdigest()\n105\t\n\n--------------------------------------------------\n>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.\n   Severity: Medium   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:117:11\n116\t    \"\"\"Unsafe deserialization\"\"\"\n117\t    return eval(data)  # Dangerous!\n118\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:131:14\n130\t    log_entry = f\"LOG: {message}\\n\"\n131\t    with open(\"/tmp/app.log\", \"a\") as f:\n132\t        f.write(log_entry)  # No sanitization\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'test123'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmp_17s_vcy.py:151:16\n150\t    test_user = \"test\"\n151\t    test_pass = \"test123\"\n152\t    \n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 120\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 3\n\t\tMedium: 6\n\t\tHigh: 1\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 3\n\t\tMedium: 5\n\t\tHigh: 2\nFiles skipped (0):"
                    },
                    {
                        "tool": "MyPy",
                        "result": "No issues found."
                    }
                ]
            },
            {
                "file_name": "sample.py",
                "language": "python",
                "code": "# bad_code_sample_v2.py\n# Intentionally insecure & non-idiomatic Python for testing analyzers.\n\nimport os, sys, json, sqlite3, hashlib, subprocess\n\n# Hardcoded credentials (Bandit will flag)\nDB_PASSWORD = \"P@ssw0rd123!\"\nAPI_KEY = \"AKIAEXAMPLESECRETKEY\"\nSECRET_TOKEN = \"s3cr3t-token-123\"\n\n# Global bad naming / shadowing builtins\nX = 5\nY=10\nlist = [1,2,3]  # shadowing built-in\n\n# Missing type hints and poor formatting\ndef add(a,b):\n  return a +  b\n\n# Function returning wrong type (MyPy will complain)\ndef greet(name: str) -> int:\n    print(\"Hello \" + name)\n    return \"Done\"  # wrong return type\n\n# Dangerous: shell command + no validation (Bandit)\ndef remove_all_logs():\n    # no checks; dangerous hardcoded path and shell=True like behavior\n    os.system(\"rm -rf /var/log\")\n\n# Dangerous use of subprocess with shell-like behavior (Bandit)\ndef run_user_command(cmd):\n    # imagine cmd comes from user input \u2014 vulnerable to injection\n    subprocess.Popen(cmd, shell=True)\n\n# Insecure eval usage (Bandit)\ndef evaluate_user_expr(expr):\n    # insecure: executing arbitrary expressions\n    return eval(expr)\n\n# Weak hashing (MD5) and use of secrets in code\ndef hash_password(pwd: str) -> str:\n    # weak cryptography (md5) \u2014 Bandit will flag\n    return hashlib.md5(pwd.encode()).hexdigest()\n\n# SQL injection style string formatting + missing exception handling\ndef add_user_to_db(username, password):\n    conn = sqlite3.connect(\"/tmp/users.db\")\n    cursor = conn.cursor()\n    # BAD: direct string interpolation into SQL (SQLi)\n    sql = f\"INSERT INTO users (username, password) VALUES ('{username}', '{password}')\"\n    cursor.execute(sql)\n    conn.commit()\n    conn.close()\n\n# File operation without exception handling (flat code)\ndef read_config():\n    # no try/except \u2014 will crash if file missing or parse fails\n    with open(\"/etc/myapp/config.json\", \"r\") as f:\n        cfg = json.load(f)\n    return cfg\n\n# Missing validation and no error handling for network-like operations\ndef send_token(token):\n    # pretend to send token; no validation or safe storage\n    print(\"Sending token:\", token)\n    # insecure: printing secret to logs\n\n# Inconsistent indentation and mixed tabs/spaces\ndef weird_indent():\n\tif True:\n\t print (\"Tabs and spaces mixed\")\n\t print('This line uses tabs')\n\n# Unused function and variables (style issues)\ndef UnusedFunction():\n    pass\n\n# Exposed secret in docstring / comments (some analyzers can flag)\n\"\"\"\nDoc: DB_PASSWORD = P@ssw0rd123!  # DO NOT COMMIT SECRETS\n\"\"\"\n\nif __name__==\"__main__\":\n  # flat, no top-level exception handling: any error will crash the program\n  greet(\"World\")\n  add(3 ,4)\n  remove_all_logs()\n  print(\"Hashed:\", hash_password(DB_PASSWORD))\n  run_user_command(\"ls -la /tmp\")    # potentially unsafe\n  print(\"Eval result:\", evaluate_user_expr(\"2 + 3\"))\n  # Potential SQL injection demo\n  add_user_to_db(\"alice\", DB_PASSWORD)\n  cfg = read_config()\n  print(cfg.get(\"some_key\"))\n",
                "analysis": [
                    {
                        "tool": "Pylint",
                        "result": "Line 18: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 70: Bad indentation. Found 1 spaces, expected 4 (bad-indentation)\nLine 71: Bad indentation. Found 2 spaces, expected 8 (bad-indentation)\nLine 72: Bad indentation. Found 2 spaces, expected 8 (bad-indentation)\nLine 85: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 86: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 87: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 88: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 89: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 90: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 92: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 93: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 94: Bad indentation. Found 2 spaces, expected 4 (bad-indentation)\nLine 1: Missing module docstring (missing-module-docstring)\nLine 14: Redefining built-in 'list' (redefined-builtin)\nLine 4: Multiple imports on one line (os, sys, json, sqlite3, hashlib, subprocess) (multiple-imports)\nLine 17: Missing function or method docstring (missing-function-docstring)\nLine 21: Missing function or method docstring (missing-function-docstring)\nLine 26: Missing function or method docstring (missing-function-docstring)\nLine 31: Missing function or method docstring (missing-function-docstring)\nLine 33: Consider using 'with' for resource-allocating operations (consider-using-with)\nLine 36: Missing function or method docstring (missing-function-docstring)\nLine 38: Use of eval (eval-used)\nLine 41: Missing function or method docstring (missing-function-docstring)\nLine 46: Missing function or method docstring (missing-function-docstring)\nLine 56: Missing function or method docstring (missing-function-docstring)\nLine 59: Redefining name 'cfg' from outer scope (line 93) (redefined-outer-name)\nLine 58: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 63: Missing function or method docstring (missing-function-docstring)\nLine 69: Missing function or method docstring (missing-function-docstring)\nLine 70: Using a conditional statement with a constant value (using-constant-test)\nLine 75: Missing function or method docstring (missing-function-docstring)\nLine 75: Function name \"UnusedFunction\" doesn't conform to snake_case naming style (invalid-name)\nLine 79: String statement has no effect (pointless-string-statement)\nLine 4: Unused import sys (unused-import)"
                    },
                    {
                        "tool": "Flake8",
                        "result": "C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:4:1: F401 'sys' imported but unused\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:4:10: E401 multiple imports on one line\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:13:2: E225 missing whitespace around operator\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:14:10: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:14:12: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:17:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:17:10: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:18:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:18:13: E222 multiple spaces after operator\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:21:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:26:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:31:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:36:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:41:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:46:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:56:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:63:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:69:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:70:1: W191 indentation contains tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:70:1: E101 indentation contains mixed spaces and tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:70:2: E117 over-indented\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:1: W191 indentation contains tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:1: E101 indentation contains mixed spaces and tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:71:8: E211 whitespace before '('\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:72:1: W191 indentation contains tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:72:1: E101 indentation contains mixed spaces and tabs\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:72:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:75:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:79:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:83:12: E225 missing whitespace around operator\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:84:3: E114 indentation is not a multiple of 4 (comment)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:85:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:86:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:86:8: E203 whitespace before ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:86:9: E231 missing whitespace after ','\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:87:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:88:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:89:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:90:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:91:3: E114 indentation is not a multiple of 4 (comment)\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:92:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:93:3: E111 indentation is not a multiple of 4\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:94:3: E111 indentation is not a multiple of 4"
                    },
                    {
                        "tool": "Ruff",
                        "result": "E401 [*] Multiple imports on one line\n --> tmppuixfmvg.py:4:1\n  |\n2 | # Intentionally insecure & non-idiomatic Python for testing analyzers.\n3 |\n4 | import os, sys, json, sqlite3, hashlib, subprocess\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n5 |\n6 | # Hardcoded credentials (Bandit will flag)\n  |\nhelp: Split imports\n\nF401 [*] `sys` imported but unused\n --> tmppuixfmvg.py:4:12\n  |\n2 | # Intentionally insecure & non-idiomatic Python for testing analyzers.\n3 |\n4 | import os, sys, json, sqlite3, hashlib, subprocess\n  |            ^^^\n5 |\n6 | # Hardcoded credentials (Bandit will flag)\n  |\nhelp: Remove unused import: `sys`"
                    },
                    {
                        "tool": "Bandit",
                        "result": "Run started:2025-10-14 14:03:08.075410\n\nTest results:\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:4:0\n3\t\n4\timport os, sys, json, sqlite3, hashlib, subprocess\n5\t\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'P@ssw0rd123!'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:7:14\n6\t# Hardcoded credentials (Bandit will flag)\n7\tDB_PASSWORD = \"P@ssw0rd123!\"\n8\tAPI_KEY = \"AKIAEXAMPLESECRETKEY\"\n\n--------------------------------------------------\n>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 's3cr3t-token-123'\n   Severity: Low   Confidence: Medium\n   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:9:15\n8\tAPI_KEY = \"AKIAEXAMPLESECRETKEY\"\n9\tSECRET_TOKEN = \"s3cr3t-token-123\"\n10\t\n\n--------------------------------------------------\n>> Issue: [B605:start_process_with_a_shell] Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b605_start_process_with_a_shell.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:28:4\n27\t    # no checks; dangerous hardcoded path and shell=True like behavior\n28\t    os.system(\"rm -rf /var/log\")\n29\t\n\n--------------------------------------------------\n>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b607_start_process_with_partial_path.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:28:4\n27\t    # no checks; dangerous hardcoded path and shell=True like behavior\n28\t    os.system(\"rm -rf /var/log\")\n29\t\n\n--------------------------------------------------\n>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.\n   Severity: High   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:33:4\n32\t    # imagine cmd comes from user input \u2014 vulnerable to injection\n33\t    subprocess.Popen(cmd, shell=True)\n34\t\n\n--------------------------------------------------\n>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.\n   Severity: Medium   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:38:11\n37\t    # insecure: executing arbitrary expressions\n38\t    return eval(expr)\n39\t\n\n--------------------------------------------------\n>> Issue: [B324:hashlib] Use of weak MD5 hash for security. Consider usedforsecurity=False\n   Severity: High   Confidence: High\n   CWE: CWE-327 (https://cwe.mitre.org/data/definitions/327.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b324_hashlib.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:43:11\n42\t    # weak cryptography (md5) \u2014 Bandit will flag\n43\t    return hashlib.md5(pwd.encode()).hexdigest()\n44\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:47:27\n46\tdef add_user_to_db(username, password):\n47\t    conn = sqlite3.connect(\"/tmp/users.db\")\n48\t    cursor = conn.cursor()\n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Low\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmppuixfmvg.py:50:10\n49\t    # BAD: direct string interpolation into SQL (SQLi)\n50\t    sql = f\"INSERT INTO users (username, password) VALUES ('{username}', '{password}')\"\n51\t    cursor.execute(sql)\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 52\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 5\n\t\tMedium: 3\n\t\tHigh: 2\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 1\n\t\tMedium: 3\n\t\tHigh: 6\nFiles skipped (0):"
                    },
                    {
                        "tool": "MyPy",
                        "result": "tmppuixfmvg.py:23: error: Incompatible return value type (got \"str\", expected \"int\")  [return-value]"
                    }
                ]
            },
            {
                "file_name": "utils.py",
                "language": "python",
                "code": "# src/utils.py\nimport pickle\nimport subprocess\nimport sys\nfrom pathlib import Path\n\nclass ConfigManager:\n    def __init__(self):\n        self.config = {}\n    \n    def load_config(self, config_path: str):\n        \"\"\"Unsafe pickle loading\"\"\"\n        with open(config_path, 'rb') as f:\n            self.config = pickle.load(f)  # Dangerous!\n    \n    def execute_command(self, command: str):\n        \"\"\"Command injection vulnerability\"\"\"\n        # No input validation\n        result = subprocess.run(command, shell=True, capture_output=True, text=True)\n        return result.stdout\n    \n    def read_arbitrary_file(self, file_path: str) -> str:\n        \"\"\"Path traversal vulnerability\"\"\"\n        base_dir = Path(\"/app/data\")\n        target_file = base_dir / file_path  # No path sanitization\n        \n        with open(target_file, 'r') as f:\n            return f.read()\n    \n    def unsafe_eval(self, expression: str):\n        \"\"\"Unsafe eval usage\"\"\"\n        return eval(expression)\n\ndef create_user_object(data: dict):\n    \"\"\"Class with too many responsibilities\"\"\"\n    class User:\n        def __init__(self, data):\n            self.data = data\n            self.db_connection = None\n            self.cache = {}\n            self.logger = None\n        \n        def validate(self):\n            # Too many validations in one method\n            if 'email' in self.data:\n                if '@' not in self.data['email']:\n                    return False\n            if 'password' in self.data:\n                if len(self.data['password']) < 3:\n                    return False\n            if 'username' in self.data:\n                if len(self.data['username']) < 2:\n                    return False\n            return True\n        \n        def save_to_db(self):\n            # Mixing concerns\n            pass\n        \n        def send_email(self):\n            # Should not be here\n            pass\n        \n        def generate_report(self):\n            # Too many responsibilities\n            pass\n    \n    return User(data)\n\n# Global state manipulation\nglobal_state = {}\n\ndef update_global_state(key: str, value: any):\n    \"\"\"Function with side effects\"\"\"\n    global_state[key] = value\n    # Also modifies external state\n    with open(\"/tmp/state.json\", \"w\") as f:\n        import json\n        json.dump(global_state, f)\n\n# Poor exception handling\ndef risky_operation():\n    try:\n        # Too broad exception handling\n        result = 10 / 0\n    except:\n        pass  # Silent failure\n\n# Inconsistent naming\ndef GetData():\n    return {\"data\": \"value\"}\n\ndef process_data():\n    return GetData()\n\ndef CalculateTotal():\n    return 100\n\n# Dead code\ndef unused_function():\n    return \"This is never called\"\n\ndef another_unused():\n    print(\"Also never used\")\n\n# Long function with multiple responsibilities\ndef process_user_request(request_data: dict) -> dict:\n    \"\"\"Function doing too many things\"\"\"\n    # Validation\n    if 'user_id' not in request_data:\n        return {\"error\": \"Missing user_id\"}\n    \n    # Database operation\n    import sqlite3\n    conn = sqlite3.connect(\"/tmp/app.db\")\n    cursor = conn.cursor()\n    cursor.execute(f\"SELECT * FROM users WHERE id = {request_data['user_id']}\")\n    user = cursor.fetchone()\n    \n    # Business logic\n    if user:\n        if user[3] == 'premium':  # Magic number\n            discount = 0.1\n        else:\n            discount = 0.0\n        \n        # Calculation\n        total = 100 * (1 - discount)\n        \n        # Formatting\n        response = {\n            \"user\": user[1],\n            \"total\": total,\n            \"discount\": discount\n        }\n        \n        # Logging\n        print(f\"Processed request for user {user[1]}\")\n        \n        return response\n    \n    return {\"error\": \"User not found\"}\n\nif __name__ == \"__main__\":\n    manager = ConfigManager()\n    manager.execute_command(\"ls -la\")  # Safe example, but pattern is dangerous",
                "analysis": [
                    {
                        "tool": "Pylint",
                        "result": "Line 10: Trailing whitespace (trailing-whitespace)\nLine 15: Trailing whitespace (trailing-whitespace)\nLine 21: Trailing whitespace (trailing-whitespace)\nLine 26: Trailing whitespace (trailing-whitespace)\nLine 29: Trailing whitespace (trailing-whitespace)\nLine 42: Trailing whitespace (trailing-whitespace)\nLine 55: Trailing whitespace (trailing-whitespace)\nLine 59: Trailing whitespace (trailing-whitespace)\nLine 63: Trailing whitespace (trailing-whitespace)\nLine 67: Trailing whitespace (trailing-whitespace)\nLine 112: Trailing whitespace (trailing-whitespace)\nLine 119: Trailing whitespace (trailing-whitespace)\nLine 126: Trailing whitespace (trailing-whitespace)\nLine 129: Trailing whitespace (trailing-whitespace)\nLine 136: Trailing whitespace (trailing-whitespace)\nLine 139: Trailing whitespace (trailing-whitespace)\nLine 141: Trailing whitespace (trailing-whitespace)\nLine 146: Final newline missing (missing-final-newline)\nLine 1: Missing module docstring (missing-module-docstring)\nLine 7: Missing class docstring (missing-class-docstring)\nLine 19: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)\nLine 27: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 32: Use of eval (eval-used)\nLine 36: Missing class docstring (missing-class-docstring)\nLine 43: Missing function or method docstring (missing-function-docstring)\nLine 56: Missing function or method docstring (missing-function-docstring)\nLine 60: Missing function or method docstring (missing-function-docstring)\nLine 64: Missing function or method docstring (missing-function-docstring)\nLine 77: Using open without explicitly specifying an encoding (unspecified-encoding)\nLine 78: Import outside toplevel (json) (import-outside-toplevel)\nLine 82: Missing function or method docstring (missing-function-docstring)\nLine 86: No exception type(s) specified (bare-except)\nLine 85: Unused variable 'result' (unused-variable)\nLine 90: Missing function or method docstring (missing-function-docstring)\nLine 90: Function name \"GetData\" doesn't conform to snake_case naming style (invalid-name)\nLine 93: Missing function or method docstring (missing-function-docstring)\nLine 96: Missing function or method docstring (missing-function-docstring)\nLine 96: Function name \"CalculateTotal\" doesn't conform to snake_case naming style (invalid-name)\nLine 100: Missing function or method docstring (missing-function-docstring)\nLine 103: Missing function or method docstring (missing-function-docstring)\nLine 114: Import outside toplevel (sqlite3) (import-outside-toplevel)\nLine 4: Unused import sys (unused-import)"
                    },
                    {
                        "tool": "Flake8",
                        "result": "C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:4:1: F401 'sys' imported but unused\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:7:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:10:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:15:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:21:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:26:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:29:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:34:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:42:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:55:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:59:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:63:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:67:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:71:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:73:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:82:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:85:9: F841 local variable 'result' is assigned to but never used\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:86:5: E722 do not use bare 'except'\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:90:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:93:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:96:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:100:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:103:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:107:1: E302 expected 2 blank lines, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:112:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:119:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:126:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:129:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:136:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:139:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:141:1: W293 blank line contains whitespace\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:144:1: E305 expected 2 blank lines after class or function definition, found 1\nC:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:146:80: W292 no newline at end of file"
                    },
                    {
                        "tool": "Ruff",
                        "result": "F401 [*] `sys` imported but unused\n --> tmpk273_tbh.py:4:8\n  |\n2 | import pickle\n3 | import subprocess\n4 | import sys\n  |        ^^^\n5 | from pathlib import Path\n  |\nhelp: Remove unused import: `sys`\n\nF841 Local variable `result` is assigned to but never used\n  --> tmpk273_tbh.py:85:9\n   |\n83 |     try:\n84 |         # Too broad exception handling\n85 |         result = 10 / 0\n   |         ^^^^^^\n86 |     except:\n87 |         pass  # Silent failure\n   |\nhelp: Remove assignment to unused variable `result`\n\nE722 Do not use bare `except`\n  --> tmpk273_tbh.py:86:5\n   |\n84 |         # Too broad exception handling\n85 |         result = 10 / 0\n86 |     except:\n   |     ^^^^^^\n87 |         pass  # Silent failure\n   |"
                    },
                    {
                        "tool": "Bandit",
                        "result": "Run started:2025-10-14 14:03:11.424252\n\nTest results:\n>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.\n   Severity: Low   Confidence: High\n   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b403-import-pickle\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:2:0\n1\t# src/utils.py\n2\timport pickle\n3\timport subprocess\n\n--------------------------------------------------\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:3:0\n2\timport pickle\n3\timport subprocess\n4\timport sys\n\n--------------------------------------------------\n>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.\n   Severity: Medium   Confidence: High\n   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:14:26\n13\t        with open(config_path, 'rb') as f:\n14\t            self.config = pickle.load(f)  # Dangerous!\n15\t    \n\n--------------------------------------------------\n>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.\n   Severity: High   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:19:17\n18\t        # No input validation\n19\t        result = subprocess.run(command, shell=True, capture_output=True, text=True)\n20\t        return result.stdout\n\n--------------------------------------------------\n>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.\n   Severity: Medium   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:32:15\n31\t        \"\"\"Unsafe eval usage\"\"\"\n32\t        return eval(expression)\n33\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:77:14\n76\t    # Also modifies external state\n77\t    with open(\"/tmp/state.json\", \"w\") as f:\n78\t        import json\n\n--------------------------------------------------\n>> Issue: [B110:try_except_pass] Try, Except, Pass detected.\n   Severity: Low   Confidence: High\n   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:86:4\n85\t        result = 10 / 0\n86\t    except:\n87\t        pass  # Silent failure\n88\t\n\n--------------------------------------------------\n>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:115:27\n114\t    import sqlite3\n115\t    conn = sqlite3.connect(\"/tmp/app.db\")\n116\t    cursor = conn.cursor()\n\n--------------------------------------------------\n>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.\n   Severity: Medium   Confidence: Medium\n   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html\n   Location: C:\\Users\\thala\\AppData\\Local\\Temp\\tmpk273_tbh.py:117:19\n116\t    cursor = conn.cursor()\n117\t    cursor.execute(f\"SELECT * FROM users WHERE id = {request_data['user_id']}\")\n118\t    user = cursor.fetchone()\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 98\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 3\n\t\tMedium: 5\n\t\tHigh: 1\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 3\n\t\tHigh: 6\nFiles skipped (0):"
                    },
                    {
                        "tool": "MyPy",
                        "result": "tmpk273_tbh.py:73: error: Function \"builtins.any\" is not valid as a type  [valid-type]\ntmpk273_tbh.py:73: note: Perhaps you meant \"typing.Any\" instead of \"any\"?"
                    }
                ]
            }
        ],
        "file_paths": [
            "sample_code_repo"
        ],
        "requirements": {
            "user_stories": [
                "As a user, I want to register with email and password",
                "As a user, I want to login with my credentials",
                "As a user, I want to reset my password if forgotten",
                "As an admin, I want to manage user accounts"
            ],
            "functional_requirements": [
                "Secure user registration with validation",
                "JWT-based authentication system",
                "Password hashing with strong algorithm",
                "Input validation to prevent SQL injection",
                "Proper error handling and logging",
                "Secure configuration management"
            ],
            "security_requirements": [
                "No hardcoded credentials",
                "Input sanitization for all user inputs",
                "Secure password storage",
                "Protection against common vulnerabilities (SQLi, XSS, etc.)",
                "Proper access controls"
            ]
        },
        "current_step": "standards_check",
        "standards_result": 